# TroubleShoot.md - 최종 안정화 및 품질 개선 이력

## 1. 세그폴트(139 에러) 및 크래시 근본 해결
단순한 메모리 관리를 넘어, 시스템의 구조적 결함을 수정하여 세그폴트를 완전히 차단했습니다.
- **의존성 경량화**: 네이티브 충돌 가능성이 높은 무거운 라이브러리(`pykrx`, `FinanceDataReader`)를 완전히 제거하여 메모리 풋프린트를 최소화했습니다.
- **스케줄러 하드닝**: `max_instances=1` 설정을 적용하여 어떤 상황에서도 동일한 수집 작업이 중복 실행되어 쓰레드 경합을 일으키지 않도록 조치했습니다.
- **환경 변수 통합**: 모든 API 키와 외부 URL을 환경 변수(`ENV.md` 참조)로 이관하여 로직을 단순화하고 유지보수 성능을 높였습니다.

## 2. 화면 깜빡임 및 데이터 소실 해결
- **문제**: 데이터 갱신 시 DOM 전체 삭제로 인한 깜빡임 및 서버 지연 시 빈 화면 노출.
- **해결**:
    1. **DOM 재사용**: `renderLayout`에서 'In-place Update' 로직 적용.
    2. **데이터 병합 전략**: `Object.assign` 기반의 프론트엔드 캐시 관리.
    3. **localStorage 영속성**: 브라우저 로컬 저장소를 활용한 중단 없는 데이터 제공.

## 3. 스케줄링 및 수집 주기 최적화
- **구조**:
    - **실시간(30초/5분)**: 상시 지표 갱신.
    - **정기(매일 01:10)**: 히스토리 차트 집중 갱신 (서버 재시작 전 수집 완료를 위해 순차 수집 속도 가속화).

## 4. 최종 결과
- Render Free 플랜의 하드웨어 제약(512MB)을 극복하고, 네이티브 레벨의 크래시 요인을 제거하여 **24시간 무중단 서비스**가 가능한 수준으로 안정화되었습니다.
